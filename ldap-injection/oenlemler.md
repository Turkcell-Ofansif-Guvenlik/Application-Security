# Önlemler

LDAP, isimleri DN tabanlı saklar. Bu DN kullanıcı adı gibi kaynaklara erişimlerde kullanılabilir.

**Örnek bir DN;**

| **cn=Richard Feynman, ou=Physics Department, dc=Caltech, dc=edu** |
| :---------------------------------------------------------------: |

DN’de bulunabilecek ve LDAP için anlamlı özel karakterler aşağıdaki gibidir. Bu karakterlerin başında ve sonunda boşluklar gelebilir.

| **\ # + < > , ; " = ( ) \* &** |
| :----------------------------: |

Her DN bir girdi göstermektedir ve arama fitreleri ile belirli özelliklere sahip kullanıcıların LDAP üzerinde aranması için sorgu yazılabilir.

**Örnek bir LDAP arama sorgusu;**

| <p><strong>(&#x26;(ou=Physics)(| (manager=cn=Freeman Dyson,ou=Physics,dc=Caltech,dc=edu)</strong></p><p><strong>(manager=cn=Albert Einstein,ou=Physics,dc=Princeton,dc=edu) ))</strong></p> |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

LDAP injection’ı engellemek için kullanıcıdan alınn girdiler, LDAP sorgusunda işletilmeden önce encode edilmelidir. Beyaz liste yaklaşımı ile girdi denetimi uygulanabilir. JAVA için OWASP ESAPI, C# için AntiXSS kütüphanesinin Encoder.LdapFilterEncode(string), Spring Framework için LDAP Query Builder kullanılabilir. OWASP ESAPI kütüphanesinde kullanılan LDAP encoder aşağıdaki gibidir.

| <p>            <strong>public String encodeForLDAP(String input, boolean encodeWildcards) {</strong></p><p>                <strong>if( input == null ) {</strong></p><p>                        <strong>return null;</strong>   </p><p>                <strong>}</strong></p><p>                        <strong>// TODO: replace with LDAP codec</strong></p><p>                <strong>StringBuilder sb = new StringBuilder();</strong></p><p>                <strong>for (int i = 0; i &#x3C; input.length(); i++) {</strong></p><p>                    <strong>char c = input.charAt(i);</strong></p><p> <strong></strong> </p><p>                    <strong>switch (c) {</strong></p><p>                        <strong>case '\\':</strong></p><p>                            <strong>sb.append("\\5c");</strong></p><p>                            <strong>break;</strong></p><p>                        <strong>case '*':</strong></p><p>                            <strong>if (encodeWildcards) {</strong></p><p>                                <strong>sb.append("\\2a");</strong></p><p>                            <strong>}</strong></p><p>                            <strong>else {</strong></p><p>                                <strong>sb.append(c);</strong></p><p>                            <strong>}</strong></p><p>                           <strong></strong>                           </p><p>                            <strong>break;</strong></p><p>                        <strong>case '(':</strong></p><p>                            <strong>sb.append("\\28");</strong></p><p>                            <strong>break;</strong></p><p>                        <strong>case ')':</strong></p><p>                            <strong>sb.append("\\29");</strong></p><p>                            <strong>break;</strong></p><p>                        <strong>case '\0':</strong></p><p>                            <strong>sb.append("\\00");</strong></p><p>                            <strong>break;</strong></p><p>                        <strong>default:</strong></p><p>                            <strong>sb.append(c);</strong></p><p>                    <strong>}</strong></p><p>                <strong>}</strong></p><p>                        <strong>return sb.toString();</strong></p><p>            <strong>}</strong></p> |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

&#x20;
